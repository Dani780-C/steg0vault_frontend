<div class="container-functions">
    <div class="header">
        <div class="logo">
            <img src="../../assets/logo-6.png" alt="Logo image">
        </div>
        <div class="action-list">
            <div class="action">
                <button mat-raised-button (click)="addResource()" style="background-color: #6d1d7b; color: #ffffff; height: 3rem; outline:none;">Upload & embed<mat-icon>add_circle_outline</mat-icon></button>
            </div>

            <div class="action">
                <button mat-raised-button (click)="tryExtraction()" style="background-color: #6d1d7b; color: #ffffff; height: 3rem; outline:none;">Try to extract<mat-icon>image_search</mat-icon></button>
            </div>
            
            <div class="action">
                <div class="user-box" style="display: flex; flex-direction: row; padding: 0.1rem 0.1rem 0.1rem 1rem; border-radius: 25px 50px 50px 25px; border-style: solid; border-color: #6d1d7b;">
                    <div class="user" style="color: #000000; text-align: center; align-self: center; margin: 0;">
                        <p style="margin: 0; padding-right: 1rem; font-size: larger;">{{email}}</p>
                    </div>
                    <button mat-fab matTooltip="Primary" #tooltip="matTooltip"
                        matTooltip="Account"
                        matTooltipPosition="below" color="primary" aria-label="Example fab with a heart icon" [matMenuTriggerFor]="belowMenuForAccountButton"
                        style="background-color: #6d1d7b;"
                        >
                        <mat-icon>account_circle</mat-icon>
                    </button>
                    <mat-menu #belowMenuForAccountButton="matMenu" yPosition="below">
                        <!-- <div class="user-info" style="padding: 10px; border-bottom-style: solid; border-bottom-color: slateblue;">
                            <div class="user-name" style="display: flex; flex-direction: row; margin-bottom: 10px;">
                                <i class="fa-solid fa-user fa-2x" style="padding-right: 10px;"></i>
                                <p style="margin: 4px 0 0 0; width: 100%; text-align: left;">Daniel Cirlan</p>
                            </div>
                            <div class="user-email" style="display: flex; flex-direction: row; margin-bottom: 10px;">
                                <i class="fa-solid fa-at fa-2x" style="padding-right: 10px;"></i>
                                <p style="margin: 4px 0 0 0; width: 100%; text-align: left;">{{email}}</p>
                            </div>
                        </div> -->
                        <button mat-menu-item (click)="logout()">
                            <div style="display: flex; flex-direction: row;">
                                <i class="fa-solid fa-right-from-bracket fa-2x" style="color: #ff0000; padding-right: 10px;"></i>
                                <p style="width: 100%; margin: 4px 0 0 0; color: red; text-align: center;">Logout</p>
                            </div>
                        </button>
                    </mat-menu>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="container">
    <div class="side-nav-bar">
        <p> Collections {{currentCollIndex}} / {{collectionResources.length}}</p>
        <aside *ngIf="this.existsAnyCollection === true">
            <div *ngFor="let coll of collectionResources">
                <div class="collName" (click)="selectCollectionToDisplay(coll)" *ngIf="coll.collectionDTO.name === currentCollection.name" 
                    style="background-color: #87848d; border-top-left-radius: 20px; border-bottom-left-radius: 20px; color: black;">
                    <i class="fa-solid fa-caret-right"></i>   {{coll.collectionDTO.name}}
                </div>
                <div class="collName" (click)="selectCollectionToDisplay(coll)" *ngIf="coll.collectionDTO.name !== currentCollection.name">
                    {{coll.collectionDTO.name}}
                </div>
            </div>
        </aside>
        <aside *ngIf="this.existsAnyCollection === false && this.timing === true" style="padding: 0;">
            <p style="height: 100%; text-align: center; color: #73669a; margin-top: 2rem;">Your new <br> collections <br> will be <br> listed here. </p>
        </aside>
    </div>
    
    <div class="collections" *ngIf="this.existsAnyCollection === true">
        <div class="collection-container">
            <div class="collection-header">
                <p class="collection-name">{{currentCollection.name}}</p>
                <!-- <button #tooltip="matTooltip"
                matTooltip="Edit collection" class="edit-collection-button" (click)="editCollection()" style="background-color: inherit; border: none; outline: none;"><i class="fa-solid fa-pen" style="color: #B197FC;"></i></button> -->
                <button #tooltip="matTooltip"
                matTooltip="Delete collection" class="delete-collection-button" (click)="deleteCollection(this.currentCollection.name || '')" style="background-color: inherit; border: none; outline: none;"><i class="fa-solid fa-trash" style="color: #9c5e5e;"></i></button>
            </div>
            <div class="collection-description">
                <p *ngIf="this.currentCollection.description !== ''" class="card-description">{{currentCollection.description}}</p>
                <p *ngIf="this.currentCollection.description === ''" class="card-description">No description</p>                                    
            </div>
            <div class="container-xl">
                <div class="row" style="width: 100%;">
                    <div class="col-md-10" style="margin: 0; width: 100%;">
                        <div id="carousel" class="carousel slide" data-ride="carousel" data-interval="0">
                            
                            <div class="carousel-indicators">
                                <div data-target="#carousel" data-slide-to=0 class="active"></div>
                                <div data-target="#carousel" attr.data-slide-to={{number}} *ngFor="let number of numberOfSlides"></div>
                            </div>
                            
                            <div class="carousel-inner">
                                <div class="carousel-item active">
                                    <div class="row">
                                        <div class="col-sm-4" *ngFor="let index of matrix[0]">
                                            <div class="thumb-wrapper">
                                                <div class="img-box">
                                                    <img [src]='this.resources[index].imageBytes' class="img-fluid" alt="Image">
                                                </div>
                                                <div class="thumb-content">
                                                    <div class="name-and-fav">
                                                        <h4 matTooltip="{{this.resources[index].name}}" matTooltipPosition="above">{{this.resources[index].name}}</h4>
                                                        <!-- <button (click)="saveResource(this.currentCollection.name || '', this.resources[index].name || '')" style="background-color: inherit; outline: none; border: none; margin: 0;">
                                                            <i #tooltip="matTooltip"
                                                            matTooltip="Unsave"
                                                            matTooltipPosition="left" *ngIf="this.resources[index].saved" class="fa-solid fa-bookmark fa-2x" style="color: #FFD43B;"></i>
                                                            <i #tooltip="matTooltip"
                                                            matTooltip="Save"
                                                            matTooltipPosition="left" *ngIf="!this.resources[index].saved" class="fa-regular fa-bookmark fa-2x" style="color: #adaca9;"></i>
                                                        </button> -->
                                                        <button (click)="downloadImage(this.resources[index].imageBytes, (this.resources[index].name || 'image') + '.' + this.resources[index].type?.toLowerCase(), ('image/' + this.resources[index].type).toLowerCase() || 'image/png')" style="background-color: inherit; outline: none; border: none; margin: 0;">
                                                            <i #tooltip="matTooltip"
                                                            matTooltip="Download"
                                                            matTooltipPosition="left" class="fa-solid fa-download fa-2x" style="color: #88857c;"></i>
                                                        </button>
                                                    </div>
                                                    <p *ngIf="this.resources[index].description !== ''" class="card-description">{{this.resources[index].description}}</p>
                                                    <p *ngIf="this.resources[index].description === ''" class="card-description">No description</p>
                                                    <div class="resource-buttons">
                                                        <button mat-mini-fab #tooltip="matTooltip"
                                                        matTooltip="Extract key"
                                                        color="primary" class="resource-button" style="width: 35%; border-radius: 5px; background-color: #6d1d7b;" (click)="extractKey(currentCollection.name, this.resources[index].name, this.resources[index].imageBytes)"><mat-icon>vpn_key</mat-icon><p style="margin: 0; padding: 0 0 0 10px; font-weight: bold; align-content: center;">Extract</p></button>
                                                        <button #tooltip="matTooltip"
                                                        matTooltip="Edit resource" class="resource-button" (click)="editResource(currentCollection.name, this.resources[index].name, this.resources[index].imageBytes)" style="background-color: inherit; border: none; outline: none;"><i class="fa-solid fa-pen fa-2x" style="color: #73669a;"></i></button>
                                                        <button #tooltip="matTooltip"
                                                        matTooltip="Delete resource" class="resource-button" (click)="deleteResource(currentCollection.name || '', this.resources[index].name || '')" style="background-color: inherit; border: none; outline: none;" ><i class="fa-solid fa-trash fa-2x" style="color: #751717;"></i></button>
                                                    </div>
                                                </div>						
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="carousel-item" *ngFor="let number of numberOfSlides">
                                    <div class="row">
                                        <div class="col-sm-4" *ngFor="let index of matrix[number]">
                                            <div class="thumb-wrapper">
                                                <div class="img-box">
                                                    <img src={{this.resources[index].imageBytes}} class="img-fluid" alt="Image">
                                                </div>
                                                <div class="thumb-content">
                                                    <div class="name-and-fav">
                                                        <h4 matTooltip="{{this.resources[index].name}}" matTooltipPosition="above">{{this.resources[index].name}}</h4>
                                                        <!-- <button (click)="saveResource(this.currentCollection.name || '', this.resources[index].name || '')" style="background-color: inherit; border: none; outline: none; margin: 0;">
                                                            <i #tooltip="matTooltip"
                                                            matTooltip="Unsave"
                                                            matTooltipPosition="left" *ngIf="this.resources[index].saved" class="fa-solid fa-bookmark fa-2x" style="color: #FFD43B;"></i>
                                                            <i #tooltip="matTooltip"
                                                            matTooltip="Save"
                                                            matTooltipPosition="left" *ngIf="!this.resources[index].saved" class="fa-regular fa-bookmark fa-2x" style="color: #adaca9;"></i>
                                                        </button> -->
                                                        <button (click)="downloadImage(this.resources[index].imageBytes, (this.resources[index].name || 'image') + '.' + this.resources[index].type?.toLowerCase(), ('image/' + this.resources[index].type).toLowerCase() || 'image/png')" style="background-color: inherit; outline: none; border: none; margin: 0;">
                                                            <i #tooltip="matTooltip"
                                                            matTooltip="Download"
                                                            matTooltipPosition="left" class="fa-solid fa-download fa-2x" style="color: #88857c;"></i>
                                                        </button>
                                                    </div>
                                                    <p *ngIf="this.resources[index].description !== ''" class="card-description">{{this.resources[index].description}}</p>
                                                    <p *ngIf="this.resources[index].description === ''" class="card-description">No description</p>
                                                    <div class="resource-buttons">
                                                        <button mat-mini-fab #tooltip="matTooltip"
                                                        matTooltip="Extract key"
                                                        color="primary" class="resource-button" style="width: 35%; border-radius: 5px; background-color: #6d1d7b;" (click)="extractKey(currentCollection.name, this.resources[index].name, this.resources[index].imageBytes)"><mat-icon>vpn_key</mat-icon><p style="margin: 0; padding: 0 0 0 10px; font-weight: bold; align-content: center;">Extract</p></button>
                                                        <button #tooltip="matTooltip"
                                                        matTooltip="Edit resource" class="resource-button" (click)="editResource(currentCollection.name, this.resources[index].name, this.resources[index].imageBytes)" style="background-color: inherit; border: none; outline: none;"><i class="fa-solid fa-pen fa-2x" style="color: #73669a;"></i></button>
                                                        <button #tooltip="matTooltip"
                                                        matTooltip="Delete resource" class="resource-button" (click)="deleteResource(currentCollection.name || '', this.resources[index].name || '')" style="background-color: inherit; border: none; outline: none;"><i class="fa-solid fa-trash fa-2x" style="color: #751717;"></i></button>
                                                    </div>
                                                </div>						
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        
                            <a *ngIf="resources.length > 3" class="carousel-control-prev" href="#carousel" data-slide="prev" style="border: none; outline: none;">
                                <i class="fa-solid fa-angle-left" style="color: #c2bcd2;"></i>
                            </a>
                            <a *ngIf="resources.length > 3" class="carousel-control-next" href="#carousel" data-slide="next" style="border: none; outline: none;">
                                <i class="fa-solid fa-angle-right" style="color: #c2bcd2;"></i>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="collections" *ngIf="this.existsAnyCollection === false && this.timing === true">
        <h2 class="title-about">About StegoVault</h2>
        <p style="font-size: large;">StegoVault helps you to keep your secrets in a safe manner. Due to the relative security of the classic encryption methods, steganography offers an additional layer of security by hiding your secret's existence in images.</p>
        <p style="font-size: large;">If you do not feel safe saving the images that carry your confidential data,  the application offers a way to download and keep it locally. At any time, you can upload again and search for the embedded secret. </p>
        <h2 class="title-about">Steganographic algorithms</h2>
        <ul>
            <li>LSB Replacement</li>
            <p>LSB Replacement hides a secret by replacing the least significant bit of each pixel.</p>
            <li>LSB Matching</li>
            <p>Compared to LSB Replacement, LSB Matching hides a secret by replacing the least significant bit of each pixel by subtracting or adding 1 when the algorithm meets an unmatch.</p>
            <li>LSB Matching Revisited</li>
            <p>The LSB Matching Revisited hides two secret bits in two consecutive pixels by modifying only one. It is an improved algorithm that uses a mathematical equation to make the hiding process possible.</p>
            <li>Binary Hamming Codes</li>
            <p>It is a powerful algorithm based on the principles of Hamming Code. The primary objective is to minimize the amount of changes a picture must undergo during the hiding process.</p>
            <li>Random Pixel And Bit Selection</li>
            <p>Random Pixel And Bit Selection selects the pixels used for the hiding procedure at random to boost security. It also maintains a great concealing capacity.</p>
            <li>Multi Bit Plane</li>
            <p>Multi Bit Plane maintains a high degree of imperceptibility by only hiding the secret in noisy regions of an image and its capacity depends on the uploaded image.</p>
        </ul>
    </div>
    
</div>

<p-toast  
    [showTransitionOptions]="'500ms'" 
    [hideTransitionOptions]="'1000ms'" 
    [life]="2000"
    [position]="'top-center'">
</p-toast>






            <!-- <div class="action-search-bar">
                <input type="text"
                    placeholder="Resource name..."
                    aria-label="Text"
                    matInput
                    [formControl]="myControl"
                    [matAutocomplete]="auto"
                    class="search-box">
                <mat-autocomplete #auto="matAutocomplete">
                    <mat-option *ngFor="let option of filteredOptions | async" [value]="option">
                        {{option}}<mat-icon *ngIf="option === 'One'">collections</mat-icon>
                        <mat-icon *ngIf="option !== 'One'">image</mat-icon>
                    </mat-option>
                </mat-autocomplete>
                <button mat-button #tooltip="matTooltip"
                matTooltip="Search"
                matTooltipPosition="right"
                class="search-button"><mat-icon>search</mat-icon></button>
            </div> -->